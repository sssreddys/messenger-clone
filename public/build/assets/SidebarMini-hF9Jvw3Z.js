import{r as l,q as le,j as r,b as It,R as D,W as Be,y as fe,a as ae,Y as Ot}from"./app-Bkgcnhfi.js";import{c as z}from"./clsx-B-dksMZM.js";import{s as Ue,l as B,o as j,O as ke,U as J,u as ne,p as pe,a as _t,d as me,x as Ge,C as Y,y as Z,b as Nt,c as Fe,q as He}from"./transition-DGGfQbD4.js";import{c as Ee,u as Mt,v as Rt,w as Ve,q as kt,j as Ft,r as At,x as Pt,y as Dt,o as Lt,z as $t,s as zt,p as Bt}from"./index-B5sfGEyg.js";import{h as ie}from"./moment-Cl4UOzQZ.js";import{o as Ut,y as Gt,u as Ke,s as qe,I as ee,n as Ht,m as Ae,b as $,t as Pe,r as Ye,c as Vt,a as Kt,G as qt,w as Yt,d as Wt}from"./Modal-CWkS4AuN.js";import{I as oe}from"./InputLabel-CtzTLB64.js";import{I as X,T as We}from"./InputError-C_REGKCu.js";const Xt=e=>window.axios.get(`${route("chats.users")}?query=${e||""}`),Jt=()=>window.axios.get(`${route("chats.users")}?archived_chats=true`),Qt=()=>window.axios.get(route("chats.notification")),Yn=e=>window.axios.get(e),Wn=e=>window.axios.post(route("chats.mark_as_read",e.id)),Xn=e=>window.axios.post(route("chats.mark_as_unread",e.id)),Jn=e=>window.axios.post(route("chats.archive",e.id)),Qn=e=>window.axios.post(route("chats.unarchive",e.id)),Zt=e=>window.axios.delete(route("chats.destroy_all",e.id)),es=(e,s)=>window.axios.post(route("chats.customize_chat",e.id),{message_color:s}),Te={data:[],current_page:1,per_page:0,last_page:1,from:0,to:0,total:0,first_page_url:"",last_page_url:"string",next_page_url:"string",prev_page_url:"string"},Xe={chats:[],paginate:Te,setChats:()=>{},setPaginate:()=>{},refetchChats:()=>{}},ts=(e,s)=>{switch(s.type){case"SET_CHATS":return{...e,chats:s.payload};case"SET_PAGINATE":return{...e,paginate:s.payload}}},Je=l.createContext(Xe),ge=()=>l.useContext(Je),Zn=({children:e})=>{const s=le().props,[t,n]=l.useReducer(ts,Xe),[o,a]=l.useState(!0),i=f=>n({type:"SET_CHATS",payload:f}),c=f=>n({type:"SET_PAGINATE",payload:f}),h=async()=>{const f=localStorage.getItem("last-sync-chats"),g=ie();if(!(f&&g.diff(ie(parseInt(f)))<3e3)){if(localStorage.setItem("last-sync-chats",g.valueOf().toString()),route().current("chats.*"))return Xt().then(b=>i(b.data.data.data));if(route().current("archived_chats.*"))return Jt().then(b=>i(b.data.data.data))}};l.useEffect(()=>{a(!1),i(s.chats.data),c(s.chats),window.Echo.channel("user-activity").listen(".user-activity",f=>{(Array.isArray(f.user)||(t.chats.length>0?t.chats:s.chats.data).find(u=>u.id===f.user.id))&&h()}),window.Echo.channel(`send-message-${s.auth.id}`).listen(".send-message",h)},[]);const d={...t,chats:o?s.chats.data:t.chats,paginate:o?s.chats:t.paginate,setChats:i,setPaginate:c,refetchChats:h};return r.jsx(Je.Provider,{value:d,children:e})};function se(e,s,t){let n=t.initialDeps??[],o;return()=>{var a,i,c,h;let d;t.key&&((a=t.debug)!=null&&a.call(t))&&(d=Date.now());const f=e();if(!(f.length!==n.length||f.some((u,m)=>n[m]!==u)))return o;n=f;let b;if(t.key&&((i=t.debug)!=null&&i.call(t))&&(b=Date.now()),o=s(...f),t.key&&((c=t.debug)!=null&&c.call(t))){const u=Math.round((Date.now()-d)*100)/100,m=Math.round((Date.now()-b)*100)/100,v=m/16,y=(x,E)=>{for(x=String(x);x.length<E;)x=" "+x;return x};console.info(`%câ± ${y(m,5)} /${y(u,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,t==null?void 0:t.key)}return(h=t==null?void 0:t.onChange)==null||h.call(t,o),o}}function we(e,s){if(e===void 0)throw new Error(`Unexpected undefined${s?`: ${s}`:""}`);return e}const ss=(e,s)=>Math.abs(e-s)<1,ns=e=>e,os=e=>{const s=Math.max(e.startIndex-e.overscan,0),t=Math.min(e.endIndex+e.overscan,e.count-1),n=[];for(let o=s;o<=t;o++)n.push(o);return n},rs=(e,s)=>{const t=e.scrollElement;if(!t)return;const n=a=>{const{width:i,height:c}=a;s({width:Math.round(i),height:Math.round(c)})};if(n(t.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const o=new ResizeObserver(a=>{const i=a[0];if(i!=null&&i.borderBoxSize){const c=i.borderBoxSize[0];if(c){n({width:c.inlineSize,height:c.blockSize});return}}n(t.getBoundingClientRect())});return o.observe(t,{box:"border-box"}),()=>{o.unobserve(t)}},as=(e,s)=>{const t=e.scrollElement;if(!t)return;const n=()=>{s(t[e.options.horizontal?"scrollLeft":"scrollTop"])};return n(),t.addEventListener("scroll",n,{passive:!0}),()=>{t.removeEventListener("scroll",n)}},is=(e,s,t)=>{if(s!=null&&s.borderBoxSize){const n=s.borderBoxSize[0];if(n)return Math.round(n[t.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[t.options.horizontal?"width":"height"])},ls=(e,{adjustments:s=0,behavior:t},n)=>{var o,a;const i=e+s;(a=(o=n.scrollElement)==null?void 0:o.scrollTo)==null||a.call(o,{[n.options.horizontal?"left":"top"]:i,behavior:t})};class cs{constructor(s){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let t=null;const n=()=>t||(typeof ResizeObserver<"u"?t=new ResizeObserver(o=>{o.forEach(a=>{this._measureElement(a.target,a)})}):null);return{disconnect:()=>{var o;return(o=n())==null?void 0:o.disconnect()},observe:o=>{var a;return(a=n())==null?void 0:a.observe(o,{box:"border-box"})},unobserve:o=>{var a;return(a=n())==null?void 0:a.unobserve(o)}}})(),this.range=null,this.setOptions=t=>{Object.entries(t).forEach(([n,o])=>{typeof o>"u"&&delete t[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:ns,rangeExtractor:os,onChange:()=>{},measureElement:is,initialRect:{width:0,height:0},scrollMargin:0,gap:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,...t}},this.notify=t=>{var n,o;(o=(n=this.options).onChange)==null||o.call(n,this,t)},this.maybeNotify=se(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),t=>{this.notify(t)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(t=>t()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const t=this.options.getScrollElement();this.scrollElement!==t&&(this.cleanup(),this.scrollElement=t,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,n=>{this.scrollRect=n,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,n=>{this.scrollAdjustments=0,this.scrollOffset!==n&&(this.isScrollingTimeoutId!==null&&(clearTimeout(this.isScrollingTimeoutId),this.isScrollingTimeoutId=null),this.isScrolling=!0,this.scrollDirection=this.scrollOffset<n?"forward":"backward",this.scrollOffset=n,this.maybeNotify(),this.isScrollingTimeoutId=setTimeout(()=>{this.isScrollingTimeoutId=null,this.isScrolling=!1,this.scrollDirection=null,this.maybeNotify()},this.options.scrollingDelay))})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.memoOptions=se(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(t,n,o,a)=>(this.pendingMeasuredCacheIndexes=[],{count:t,paddingStart:n,scrollMargin:o,getItemKey:a}),{key:!1}),this.getFurthestMeasurement=(t,n)=>{const o=new Map,a=new Map;for(let i=n-1;i>=0;i--){const c=t[i];if(o.has(c.lane))continue;const h=a.get(c.lane);if(h==null||c.end>h.end?a.set(c.lane,c):c.end<h.end&&o.set(c.lane,!0),o.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((i,c)=>i.end===c.end?i.index-c.index:i.end-c.end)[0]:void 0},this.getMeasurements=se(()=>[this.memoOptions(),this.itemSizeCache],({count:t,paddingStart:n,scrollMargin:o,getItemKey:a},i)=>{const c=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const h=this.measurementsCache.slice(0,c);for(let d=c;d<t;d++){const f=a(d),g=this.options.lanes===1?h[d-1]:this.getFurthestMeasurement(h,d),b=g?g.end+this.options.gap:n+o,u=i.get(f),m=typeof u=="number"?u:this.options.estimateSize(d),v=b+m,y=g?g.lane:d%this.options.lanes;h[d]={index:d,start:b,size:m,end:v,key:f,lane:y}}return this.measurementsCache=h,h},{key:!1,debug:()=>this.options.debug}),this.calculateRange=se(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(t,n,o)=>this.range=t.length>0&&n>0?us({measurements:t,outerSize:n,scrollOffset:o}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=se(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(t,n,o,a)=>n===null?[]:t({...n,overscan:o,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=t=>{const n=this.options.indexAttribute,o=t.getAttribute(n);return o?parseInt(o,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(t,n)=>{const o=this.measurementsCache[this.indexFromElement(t)];if(!o||!t.isConnected){this.measureElementCache.forEach((c,h)=>{c===t&&(this.observer.unobserve(t),this.measureElementCache.delete(h))});return}const a=this.measureElementCache.get(o.key);a!==t&&(a&&this.observer.unobserve(a),this.observer.observe(t),this.measureElementCache.set(o.key,t));const i=this.options.measureElement(t,n,this);this.resizeItem(o,i)},this.resizeItem=(t,n)=>{const o=this.itemSizeCache.get(t.key)??t.size,a=n-o;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(t,a,this):t.start<this.scrollOffset+this.scrollAdjustments)&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(t.index),this.itemSizeCache=new Map(this.itemSizeCache.set(t.key,n)),this.notify(!1))},this.measureElement=t=>{t&&this._measureElement(t,void 0)},this.getVirtualItems=se(()=>[this.getIndexes(),this.getMeasurements()],(t,n)=>{const o=[];for(let a=0,i=t.length;a<i;a++){const c=t[a],h=n[c];o.push(h)}return o},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=t=>{const n=this.getMeasurements();return we(n[Qe(0,n.length-1,o=>we(n[o]).start,t)])},this.getOffsetForAlignment=(t,n)=>{const o=this.getSize();n==="auto"&&(t<=this.scrollOffset?n="start":t>=this.scrollOffset+o?n="end":n="start"),n==="start"?t=t:n==="end"?t=t-o:n==="center"&&(t=t-o/2);const a=this.options.horizontal?"scrollWidth":"scrollHeight",c=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[a]:this.scrollElement[a]:0)-this.getSize();return Math.max(Math.min(c,t),0)},this.getOffsetForIndex=(t,n="auto")=>{t=Math.max(0,Math.min(t,this.options.count-1));const o=we(this.getMeasurements()[t]);if(n==="auto")if(o.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)n="end";else if(o.start<=this.scrollOffset+this.options.scrollPaddingStart)n="start";else return[this.scrollOffset,n];const a=n==="end"?o.end+this.options.scrollPaddingEnd:o.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,n),n]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(t,{align:n="start",behavior:o}={})=>{this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(t,n),{adjustments:void 0,behavior:o})},this.scrollToIndex=(t,{align:n="auto",behavior:o}={})=>{t=Math.max(0,Math.min(t,this.options.count-1)),this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[a,i]=this.getOffsetForIndex(t,n);this._scrollToOffset(a,{adjustments:void 0,behavior:o}),o!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(t))){const[h]=this.getOffsetForIndex(t,i);ss(h,this.scrollOffset)||this.scrollToIndex(t,{align:i,behavior:o})}else this.scrollToIndex(t,{align:i,behavior:o})}))},this.scrollBy=(t,{behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+t,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var t;const n=this.getMeasurements();let o;return n.length===0?o=this.options.paddingStart:o=this.options.lanes===1?((t=n[n.length-1])==null?void 0:t.end)??0:Math.max(...n.slice(-this.options.lanes).map(a=>a.end)),o-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(t,{adjustments:n,behavior:o})=>{this.options.scrollToFn(t,{behavior:o,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(s),this.scrollRect=this.options.initialRect,this.scrollOffset=typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(t=>{this.itemSizeCache.set(t.key,t.size)}),this.maybeNotify()}}const Qe=(e,s,t,n)=>{for(;e<=s;){const o=(e+s)/2|0,a=t(o);if(a<n)e=o+1;else if(a>n)s=o-1;else return o}return e>0?e-1:0};function us({measurements:e,outerSize:s,scrollOffset:t}){const n=e.length-1,a=Qe(0,n,c=>e[c].start,t);let i=a;for(;i<n&&e[i].end<t+s;)i++;return{startIndex:a,endIndex:i}}const ds=typeof document<"u"?l.useLayoutEffect:l.useEffect;function hs(e){const s=l.useReducer(()=>({}),{})[1],t={...e,onChange:(o,a)=>{var i;a?It.flushSync(s):s(),(i=e.onChange)==null||i.call(e,o,a)}},[n]=l.useState(()=>new cs(t));return n.setOptions(t),l.useEffect(()=>n._didMount(),[]),ds(()=>n._willUpdate()),n}function fs(e){return hs({observeElementRect:rs,observeElementOffset:as,scrollToFn:ls,...e})}function Ie(e,s){let[t,n]=l.useState(e),o=Ue(e);return B(()=>n(o.current),[o,n,...s]),t}function Ze(e,s,t){let[n,o]=l.useState(t),a=e!==void 0,i=l.useRef(a),c=l.useRef(!1),h=l.useRef(!1);return a&&!i.current&&!c.current?(c.current=!0,i.current=a,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!a&&i.current&&!h.current&&(h.current=!0,i.current=a,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[a?e:n,j(d=>(a||o(d),s==null?void 0:s(d)))]}function De(e){var s;if(e.type)return e.type;let t=(s=e.as)!=null?s:"button";if(typeof t=="string"&&t.toLowerCase()==="button")return"button"}function et(e,s){let[t,n]=l.useState(()=>De(e));return B(()=>{n(De(e))},[e.type,e.as]),B(()=>{t||s.current&&s.current instanceof HTMLButtonElement&&!s.current.hasAttribute("type")&&n("button")},[t,s]),t}function Le(e){return[e.screenX,e.screenY]}function ms(){let e=l.useRef([-1,-1]);return{wasMoved(s){let t=Le(s);return e.current[0]===t[0]&&e.current[1]===t[1]?!1:(e.current=t,!0)},update(s){e.current=Le(s)}}}function ps({container:e,accept:s,walk:t,enabled:n=!0}){let o=l.useRef(s),a=l.useRef(t);l.useEffect(()=>{o.current=s,a.current=t},[s,t]),B(()=>{if(!e||!n)return;let i=Ut(e);if(!i)return;let c=o.current,h=a.current,d=Object.assign(g=>c(g),{acceptNode:c}),f=i.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,d,!1);for(;f.nextNode();)h(f.currentNode)},[e,n,o,a])}function gs(e){throw new Error("Unexpected object: "+e)}var k=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(k||{});function $e(e,s){let t=s.resolveItems();if(t.length<=0)return null;let n=s.resolveActiveIndex(),o=n??-1;switch(e.focus){case 0:{for(let a=0;a<t.length;++a)if(!s.resolveDisabled(t[a],a,t))return a;return n}case 1:{for(let a=o-1;a>=0;--a)if(!s.resolveDisabled(t[a],a,t))return a;return n}case 2:{for(let a=o+1;a<t.length;++a)if(!s.resolveDisabled(t[a],a,t))return a;return n}case 3:{for(let a=t.length-1;a>=0;--a)if(!s.resolveDisabled(t[a],a,t))return a;return n}case 4:{for(let a=0;a<t.length;++a)if(s.resolveId(t[a],a,t)===e.id)return a;return n}case 5:return null;default:gs(e)}}function tt(e={},s=null,t=[]){for(let[n,o]of Object.entries(e))nt(t,st(s,n),o);return t}function st(e,s){return e?e+"["+s+"]":s}function nt(e,s,t){if(Array.isArray(t))for(let[n,o]of t.entries())nt(e,st(s,n.toString()),o);else t instanceof Date?e.push([s,t.toISOString()]):typeof t=="boolean"?e.push([s,t?"1":"0"]):typeof t=="string"?e.push([s,t]):typeof t=="number"?e.push([s,`${t}`]):t==null?e.push([s,""]):tt(t,s,e)}function xs(e){var s,t;let n=(s=e==null?void 0:e.form)!=null?s:e.closest("form");if(n){for(let o of n.elements)if(o!==e&&(o.tagName==="INPUT"&&o.type==="submit"||o.tagName==="BUTTON"&&o.type==="submit"||o.nodeName==="INPUT"&&o.type==="image")){o.click();return}(t=n.requestSubmit)==null||t.call(n)}}var bs={},vs=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(vs||{}),ys=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(ys||{}),Cs=(e=>(e[e.Pointer=0]="Pointer",e[e.Focus=1]="Focus",e[e.Other=2]="Other",e))(Cs||{}),Ss=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.RegisterOption=3]="RegisterOption",e[e.UnregisterOption=4]="UnregisterOption",e[e.RegisterLabel=5]="RegisterLabel",e[e.SetActivationTrigger=6]="SetActivationTrigger",e[e.UpdateVirtualOptions=7]="UpdateVirtualOptions",e))(Ss||{});function je(e,s=t=>t){let t=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,n=s(e.options.slice()),o=n.length>0&&n[0].dataRef.current.order!==null?n.sort((i,c)=>i.dataRef.current.order-c.dataRef.current.order):Kt(n,i=>i.dataRef.current.domRef.current),a=t?o.indexOf(t):null;return a===-1&&(a=null),{options:o,activeOptionIndex:a}}let ws={1(e){var s;return(s=e.dataRef.current)!=null&&s.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},0(e){var s,t;if((s=e.dataRef.current)!=null&&s.disabled||e.comboboxState===0)return e;if((t=e.dataRef.current)!=null&&t.value){let n=e.dataRef.current.calculateIndex(e.dataRef.current.value);if(n!==-1)return{...e,activeOptionIndex:n,comboboxState:0}}return{...e,comboboxState:0}},2(e,s){var t,n,o,a,i;if((t=e.dataRef.current)!=null&&t.disabled||(n=e.dataRef.current)!=null&&n.optionsRef.current&&!((o=e.dataRef.current)!=null&&o.optionsPropsRef.current.static)&&e.comboboxState===1)return e;if(e.virtual){let f=s.focus===k.Specific?s.idx:$e(s,{resolveItems:()=>e.virtual.options,resolveActiveIndex:()=>{var b,u;return(u=(b=e.activeOptionIndex)!=null?b:e.virtual.options.findIndex(m=>!e.virtual.disabled(m)))!=null?u:null},resolveDisabled:e.virtual.disabled,resolveId(){throw new Error("Function not implemented.")}}),g=(a=s.trigger)!=null?a:2;return e.activeOptionIndex===f&&e.activationTrigger===g?e:{...e,activeOptionIndex:f,activationTrigger:g}}let c=je(e);if(c.activeOptionIndex===null){let f=c.options.findIndex(g=>!g.dataRef.current.disabled);f!==-1&&(c.activeOptionIndex=f)}let h=s.focus===k.Specific?s.idx:$e(s,{resolveItems:()=>c.options,resolveActiveIndex:()=>c.activeOptionIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled}),d=(i=s.trigger)!=null?i:2;return e.activeOptionIndex===h&&e.activationTrigger===d?e:{...e,...c,activeOptionIndex:h,activationTrigger:d}},3:(e,s)=>{var t,n,o;if((t=e.dataRef.current)!=null&&t.virtual)return{...e,options:[...e.options,s.payload]};let a=s.payload,i=je(e,h=>(h.push(a),h));e.activeOptionIndex===null&&(n=e.dataRef.current)!=null&&n.isSelected(s.payload.dataRef.current.value)&&(i.activeOptionIndex=i.options.indexOf(a));let c={...e,...i,activationTrigger:2};return(o=e.dataRef.current)!=null&&o.__demoMode&&e.dataRef.current.value===void 0&&(c.activeOptionIndex=0),c},4:(e,s)=>{var t;if((t=e.dataRef.current)!=null&&t.virtual)return{...e,options:e.options.filter(o=>o.id!==s.id)};let n=je(e,o=>{let a=o.findIndex(i=>i.id===s.id);return a!==-1&&o.splice(a,1),o});return{...e,...n,activationTrigger:2}},5:(e,s)=>e.labelId===s.id?e:{...e,labelId:s.id},6:(e,s)=>e.activationTrigger===s.trigger?e:{...e,activationTrigger:s.trigger},7:(e,s)=>{var t;if(((t=e.virtual)==null?void 0:t.options)===s.options)return e;let n=e.activeOptionIndex;if(e.activeOptionIndex!==null){let o=s.options.indexOf(e.virtual.options[e.activeOptionIndex]);o!==-1?n=o:n=null}return{...e,activeOptionIndex:n,virtual:Object.assign({},e.virtual,{options:s.options})}}},Oe=l.createContext(null);Oe.displayName="ComboboxActionsContext";function ce(e){let s=l.useContext(Oe);if(s===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ce),t}return s}let ot=l.createContext(null);function js(e){var s;let t=te("VirtualProvider"),[n,o]=l.useMemo(()=>{let h=t.optionsRef.current;if(!h)return[0,0];let d=window.getComputedStyle(h);return[parseFloat(d.paddingBlockStart||d.paddingTop),parseFloat(d.paddingBlockEnd||d.paddingBottom)]},[t.optionsRef.current]),a=fs({scrollPaddingStart:n,scrollPaddingEnd:o,count:t.virtual.options.length,estimateSize(){return 40},getScrollElement(){var h;return(h=t.optionsRef.current)!=null?h:null},overscan:12}),[i,c]=l.useState(0);return B(()=>{c(h=>h+1)},[(s=t.virtual)==null?void 0:s.options]),D.createElement(ot.Provider,{value:a},D.createElement("div",{style:{position:"relative",width:"100%",height:`${a.getTotalSize()}px`},ref:h=>{if(h){if(typeof process<"u"&&bs.JEST_WORKER_ID!==void 0||t.activationTrigger===0)return;t.activeOptionIndex!==null&&t.virtual.options.length>t.activeOptionIndex&&a.scrollToIndex(t.activeOptionIndex)}}},a.getVirtualItems().map(h=>{var d;return D.createElement(l.Fragment,{key:h.key},D.cloneElement((d=e.children)==null?void 0:d.call(e,{option:t.virtual.options[h.index],open:t.comboboxState===0}),{key:`${i}-${h.key}`,"data-index":h.index,"aria-setsize":t.virtual.options.length,"aria-posinset":h.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${h.start}px)`,overflowAnchor:"none"}}))})))}let _e=l.createContext(null);_e.displayName="ComboboxDataContext";function te(e){let s=l.useContext(_e);if(s===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,te),t}return s}function Es(e,s){return ne(s.type,ws,e,s)}let Ts=l.Fragment;function Is(e,s){let{value:t,defaultValue:n,onChange:o,form:a,name:i,by:c=null,disabled:h=!1,__demoMode:d=!1,nullable:f=!1,multiple:g=!1,immediate:b=!1,virtual:u=null,...m}=e,v=!1,y=null,[x=g?[]:void 0,E]=Ze(t,o,n),[T,N]=l.useReducer(Es,{dataRef:l.createRef(),comboboxState:d?0:1,options:[],virtual:null,activeOptionIndex:null,activationTrigger:2,labelId:null}),F=l.useRef(!1),C=l.useRef({static:!1,hold:!1}),A=l.useRef(null),W=l.useRef(null),M=l.useRef(null),O=l.useRef(null),_=j(typeof c=="string"?(w,I)=>{let U=c;return(w==null?void 0:w[U])===(I==null?void 0:I[U])}:c??((w,I)=>w===I)),G=j(w=>T.options.findIndex(I=>_(I.dataRef.current.value,w))),ve=l.useCallback(w=>ne(p.mode,{1:()=>x.some(I=>_(I,w)),0:()=>_(x,w)}),[x]),ye=j(w=>T.activeOptionIndex===G(w)),p=l.useMemo(()=>({...T,immediate:v,optionsPropsRef:C,labelRef:A,inputRef:W,buttonRef:M,optionsRef:O,value:x,defaultValue:n,disabled:h,mode:g?1:0,virtual:T.virtual,get activeOptionIndex(){if(F.current&&T.activeOptionIndex===null&&T.options.length>0){let w=T.options.findIndex(I=>!I.dataRef.current.disabled);if(w!==-1)return w}return T.activeOptionIndex},calculateIndex:G,compare:_,isSelected:ve,isActive:ye,nullable:f,__demoMode:d}),[x,n,h,g,f,d,T,y]);B(()=>{},[y,void 0]),B(()=>{T.dataRef.current=p},[p]),Gt([p.buttonRef,p.inputRef,p.optionsRef],()=>Se.closeCombobox(),p.comboboxState===0);let L=l.useMemo(()=>{var w,I,U;return{open:p.comboboxState===0,disabled:h,activeIndex:p.activeOptionIndex,activeOption:p.activeOptionIndex===null?null:p.virtual?p.virtual.options[(w=p.activeOptionIndex)!=null?w:0]:(U=(I=p.options[p.activeOptionIndex])==null?void 0:I.dataRef.current.value)!=null?U:null,value:x}},[p,h,x]),P=j(()=>{if(p.activeOptionIndex!==null){if(p.virtual)Ce(p.virtual.options[p.activeOptionIndex]);else{let{dataRef:w}=p.options[p.activeOptionIndex];Ce(w.current.value)}Se.goToOption(k.Specific,p.activeOptionIndex)}}),K=j(()=>{N({type:0}),F.current=!0}),R=j(()=>{N({type:1}),F.current=!1}),H=j((w,I,U)=>(F.current=!1,w===k.Specific?N({type:2,focus:k.Specific,idx:I,trigger:U}):N({type:2,focus:w,trigger:U}))),Q=j((w,I)=>(N({type:3,payload:{id:w,dataRef:I}}),()=>{p.isActive(I.current.value)&&(F.current=!0),N({type:4,id:w})})),wt=j(w=>(N({type:5,id:w}),()=>N({type:5,id:null}))),Ce=j(w=>ne(p.mode,{0(){return E==null?void 0:E(w)},1(){let I=p.value.slice(),U=I.findIndex(he=>_(he,w));return U===-1?I.push(w):I.splice(U,1),E==null?void 0:E(I)}})),jt=j(w=>{N({type:6,trigger:w})}),Se=l.useMemo(()=>({onChange:Ce,registerOption:Q,registerLabel:wt,goToOption:H,closeCombobox:R,openCombobox:K,setActivationTrigger:jt,selectActiveOption:P}),[]),Et=s===null?{}:{ref:s},de=l.useRef(null),Tt=pe();return l.useEffect(()=>{de.current&&n!==void 0&&Tt.addEventListener(de.current,"reset",()=>{E==null||E(n)})},[de,E]),D.createElement(Oe.Provider,{value:Se},D.createElement(_e.Provider,{value:p},D.createElement(_t,{value:ne(p.comboboxState,{0:me.Open,1:me.Closed})},i!=null&&x!=null&&tt({[i]:x}).map(([w,I],U)=>D.createElement(Ke,{features:qe.Hidden,ref:U===0?he=>{var Re;de.current=(Re=he==null?void 0:he.closest("form"))!=null?Re:null}:void 0,...Ge({key:w,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:a,disabled:h,name:w,value:I})})),Y({ourProps:Et,theirProps:m,slot:L,defaultTag:Ts,name:"Combobox"}))))}let Os="input";function _s(e,s){var t,n,o,a,i;let c=ee(),{id:h=`headlessui-combobox-input-${c}`,onChange:d,displayValue:f,type:g="text",...b}=e,u=te("Combobox.Input"),m=ce("Combobox.Input"),v=Z(u.inputRef,s),y=Ht(u.inputRef),x=l.useRef(!1),E=pe(),T=j(()=>{m.onChange(null),u.optionsRef.current&&(u.optionsRef.current.scrollTop=0),m.goToOption(k.Nothing)}),N=function(){var p;return typeof f=="function"&&u.value!==void 0?(p=f(u.value))!=null?p:"":typeof u.value=="string"?u.value:""}();Ae(([p,L],[P,K])=>{if(x.current)return;let R=u.inputRef.current;R&&((K===0&&L===1||p!==P)&&(R.value=p),requestAnimationFrame(()=>{if(x.current||!R||(y==null?void 0:y.activeElement)!==R)return;let{selectionStart:H,selectionEnd:Q}=R;Math.abs((Q??0)-(H??0))===0&&H===0&&R.setSelectionRange(R.value.length,R.value.length)}))},[N,u.comboboxState,y]),Ae(([p],[L])=>{if(p===0&&L===1){if(x.current)return;let P=u.inputRef.current;if(!P)return;let K=P.value,{selectionStart:R,selectionEnd:H,selectionDirection:Q}=P;P.value="",P.value=K,Q!==null?P.setSelectionRange(R,H,Q):P.setSelectionRange(R,H)}},[u.comboboxState]);let F=l.useRef(!1),C=j(()=>{F.current=!0}),A=j(()=>{E.nextFrame(()=>{F.current=!1})}),W=j(p=>{switch(x.current=!0,p.key){case $.Enter:if(x.current=!1,u.comboboxState!==0||F.current)return;if(p.preventDefault(),p.stopPropagation(),u.activeOptionIndex===null){m.closeCombobox();return}m.selectActiveOption(),u.mode===0&&m.closeCombobox();break;case $.ArrowDown:return x.current=!1,p.preventDefault(),p.stopPropagation(),ne(u.comboboxState,{0:()=>m.goToOption(k.Next),1:()=>m.openCombobox()});case $.ArrowUp:return x.current=!1,p.preventDefault(),p.stopPropagation(),ne(u.comboboxState,{0:()=>m.goToOption(k.Previous),1:()=>{m.openCombobox(),E.nextFrame(()=>{u.value||m.goToOption(k.Last)})}});case $.Home:if(p.shiftKey)break;return x.current=!1,p.preventDefault(),p.stopPropagation(),m.goToOption(k.First);case $.PageUp:return x.current=!1,p.preventDefault(),p.stopPropagation(),m.goToOption(k.First);case $.End:if(p.shiftKey)break;return x.current=!1,p.preventDefault(),p.stopPropagation(),m.goToOption(k.Last);case $.PageDown:return x.current=!1,p.preventDefault(),p.stopPropagation(),m.goToOption(k.Last);case $.Escape:return x.current=!1,u.comboboxState!==0?void 0:(p.preventDefault(),u.optionsRef.current&&!u.optionsPropsRef.current.static&&p.stopPropagation(),u.nullable&&u.mode===0&&u.value===null&&T(),m.closeCombobox());case $.Tab:if(x.current=!1,u.comboboxState!==0)return;u.mode===0&&u.activationTrigger!==1&&m.selectActiveOption(),m.closeCombobox();break}}),M=j(p=>{d==null||d(p),u.nullable&&u.mode===0&&p.target.value===""&&T(),m.openCombobox()}),O=j(p=>{var L,P,K;let R=(L=p.relatedTarget)!=null?L:Pe.find(H=>H!==p.currentTarget);if(x.current=!1,!((P=u.optionsRef.current)!=null&&P.contains(R))&&!((K=u.buttonRef.current)!=null&&K.contains(R))&&u.comboboxState===0)return p.preventDefault(),u.mode===0&&(u.nullable&&u.value===null?T():u.activationTrigger!==1&&m.selectActiveOption()),m.closeCombobox()}),_=j(p=>{var L,P,K;let R=(L=p.relatedTarget)!=null?L:Pe.find(H=>H!==p.currentTarget);(P=u.buttonRef.current)!=null&&P.contains(R)||(K=u.optionsRef.current)!=null&&K.contains(R)||u.disabled||u.immediate&&u.comboboxState!==0&&(m.openCombobox(),E.nextFrame(()=>{m.setActivationTrigger(1)}))}),G=Ie(()=>{if(u.labelId)return[u.labelId].join(" ")},[u.labelId]),ve=l.useMemo(()=>({open:u.comboboxState===0,disabled:u.disabled}),[u]),ye={ref:v,id:h,role:"combobox",type:g,"aria-controls":(t=u.optionsRef.current)==null?void 0:t.id,"aria-expanded":u.comboboxState===0,"aria-activedescendant":u.activeOptionIndex===null?void 0:u.virtual?(n=u.options.find(p=>{var L;return!((L=u.virtual)!=null&&L.disabled(p.dataRef.current.value))&&u.compare(p.dataRef.current.value,u.virtual.options[u.activeOptionIndex])}))==null?void 0:n.id:(o=u.options[u.activeOptionIndex])==null?void 0:o.id,"aria-labelledby":G,"aria-autocomplete":"list",defaultValue:(i=(a=e.defaultValue)!=null?a:u.defaultValue!==void 0?f==null?void 0:f(u.defaultValue):null)!=null?i:u.defaultValue,disabled:u.disabled,onCompositionStart:C,onCompositionEnd:A,onKeyDown:W,onChange:M,onFocus:_,onBlur:O};return Y({ourProps:ye,theirProps:b,slot:ve,defaultTag:Os,name:"Combobox.Input"})}let Ns="button";function Ms(e,s){var t;let n=te("Combobox.Button"),o=ce("Combobox.Button"),a=Z(n.buttonRef,s),i=ee(),{id:c=`headlessui-combobox-button-${i}`,...h}=e,d=pe(),f=j(v=>{switch(v.key){case $.ArrowDown:return v.preventDefault(),v.stopPropagation(),n.comboboxState===1&&o.openCombobox(),d.nextFrame(()=>{var y;return(y=n.inputRef.current)==null?void 0:y.focus({preventScroll:!0})});case $.ArrowUp:return v.preventDefault(),v.stopPropagation(),n.comboboxState===1&&(o.openCombobox(),d.nextFrame(()=>{n.value||o.goToOption(k.Last)})),d.nextFrame(()=>{var y;return(y=n.inputRef.current)==null?void 0:y.focus({preventScroll:!0})});case $.Escape:return n.comboboxState!==0?void 0:(v.preventDefault(),n.optionsRef.current&&!n.optionsPropsRef.current.static&&v.stopPropagation(),o.closeCombobox(),d.nextFrame(()=>{var y;return(y=n.inputRef.current)==null?void 0:y.focus({preventScroll:!0})}));default:return}}),g=j(v=>{if(Ye(v.currentTarget))return v.preventDefault();n.comboboxState===0?o.closeCombobox():(v.preventDefault(),o.openCombobox()),d.nextFrame(()=>{var y;return(y=n.inputRef.current)==null?void 0:y.focus({preventScroll:!0})})}),b=Ie(()=>{if(n.labelId)return[n.labelId,c].join(" ")},[n.labelId,c]),u=l.useMemo(()=>({open:n.comboboxState===0,disabled:n.disabled,value:n.value}),[n]),m={ref:a,id:c,type:et(e,n.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(t=n.optionsRef.current)==null?void 0:t.id,"aria-expanded":n.comboboxState===0,"aria-labelledby":b,disabled:n.disabled,onClick:g,onKeyDown:f};return Y({ourProps:m,theirProps:h,slot:u,defaultTag:Ns,name:"Combobox.Button"})}let Rs="label";function ks(e,s){let t=ee(),{id:n=`headlessui-combobox-label-${t}`,...o}=e,a=te("Combobox.Label"),i=ce("Combobox.Label"),c=Z(a.labelRef,s);B(()=>i.registerLabel(n),[n]);let h=j(()=>{var f;return(f=a.inputRef.current)==null?void 0:f.focus({preventScroll:!0})}),d=l.useMemo(()=>({open:a.comboboxState===0,disabled:a.disabled}),[a]);return Y({ourProps:{ref:c,id:n,onClick:h},theirProps:o,slot:d,defaultTag:Rs,name:"Combobox.Label"})}let Fs="ul",As=ke.RenderStrategy|ke.Static;function Ps(e,s){let t=ee(),{id:n=`headlessui-combobox-options-${t}`,hold:o=!1,...a}=e,i=te("Combobox.Options"),c=Z(i.optionsRef,s),h=Nt(),d=h!==null?(h&me.Open)===me.Open:i.comboboxState===0;B(()=>{var u;i.optionsPropsRef.current.static=(u=e.static)!=null?u:!1},[i.optionsPropsRef,e.static]),B(()=>{i.optionsPropsRef.current.hold=o},[i.optionsPropsRef,o]),ps({container:i.optionsRef.current,enabled:i.comboboxState===0,accept(u){return u.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:u.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(u){u.setAttribute("role","none")}});let f=Ie(()=>{var u,m;return(m=i.labelId)!=null?m:(u=i.buttonRef.current)==null?void 0:u.id},[i.labelId,i.buttonRef.current]),g=l.useMemo(()=>({open:i.comboboxState===0,option:void 0}),[i]),b={"aria-labelledby":f,role:"listbox","aria-multiselectable":i.mode===1?!0:void 0,id:n,ref:c};return i.virtual&&i.comboboxState===0&&Object.assign(a,{children:D.createElement(js,null,a.children)}),Y({ourProps:b,theirProps:a,slot:g,defaultTag:Fs,features:As,visible:d,name:"Combobox.Options"})}let Ds="li";function Ls(e,s){var t;let n=ee(),{id:o=`headlessui-combobox-option-${n}`,disabled:a=!1,value:i,order:c=null,...h}=e,d=te("Combobox.Option"),f=ce("Combobox.Option"),g=d.virtual?d.activeOptionIndex===d.calculateIndex(i):d.activeOptionIndex===null?!1:((t=d.options[d.activeOptionIndex])==null?void 0:t.id)===o,b=d.isSelected(i),u=l.useRef(null),m=Ue({disabled:a,value:i,domRef:u,order:c}),v=l.useContext(ot),y=Z(s,u,v?v.measureElement:null),x=j(()=>f.onChange(i));B(()=>f.registerOption(o,m),[m,o]);let E=l.useRef(!(d.virtual||d.__demoMode));B(()=>{if(!d.virtual||!d.__demoMode)return;let O=Fe();return O.requestAnimationFrame(()=>{E.current=!0}),O.dispose},[d.virtual,d.__demoMode]),B(()=>{if(!E.current||d.comboboxState!==0||!g||d.activationTrigger===0)return;let O=Fe();return O.requestAnimationFrame(()=>{var _,G;(G=(_=u.current)==null?void 0:_.scrollIntoView)==null||G.call(_,{block:"nearest"})}),O.dispose},[u,g,d.comboboxState,d.activationTrigger,d.activeOptionIndex]);let T=j(O=>{var _;if(a||(_=d.virtual)!=null&&_.disabled(i))return O.preventDefault();x(),Vt()||requestAnimationFrame(()=>{var G;return(G=d.inputRef.current)==null?void 0:G.focus({preventScroll:!0})}),d.mode===0&&requestAnimationFrame(()=>f.closeCombobox())}),N=j(()=>{var O;if(a||(O=d.virtual)!=null&&O.disabled(i))return f.goToOption(k.Nothing);let _=d.calculateIndex(i);f.goToOption(k.Specific,_)}),F=ms(),C=j(O=>F.update(O)),A=j(O=>{var _;if(!F.wasMoved(O)||a||(_=d.virtual)!=null&&_.disabled(i)||g)return;let G=d.calculateIndex(i);f.goToOption(k.Specific,G,0)}),W=j(O=>{var _;F.wasMoved(O)&&(a||(_=d.virtual)!=null&&_.disabled(i)||g&&(d.optionsPropsRef.current.hold||f.goToOption(k.Nothing)))}),M=l.useMemo(()=>({active:g,selected:b,disabled:a}),[g,b,a]);return Y({ourProps:{id:o,ref:y,role:"option",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-selected":b,disabled:void 0,onClick:T,onFocus:N,onPointerEnter:C,onMouseEnter:C,onPointerMove:A,onMouseMove:A,onPointerLeave:W,onMouseLeave:W},theirProps:h,slot:M,defaultTag:Ds,name:"Combobox.Option"})}let $s=J(Is),zs=J(Ms),Bs=J(_s),Us=J(ks),Gs=J(Ps),Hs=J(Ls),re=Object.assign($s,{Input:Bs,Button:zs,Label:Us,Options:Gs,Option:Hs}),rt=l.createContext(null);function at(){let e=l.useContext(rt);if(e===null){let s=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(s,at),s}return e}function Vs(){let[e,s]=l.useState([]);return[e.length>0?e.join(" "):void 0,l.useMemo(()=>function(t){let n=j(a=>(s(i=>[...i,a]),()=>s(i=>{let c=i.slice(),h=c.indexOf(a);return h!==-1&&c.splice(h,1),c}))),o=l.useMemo(()=>({register:n,slot:t.slot,name:t.name,props:t.props}),[n,t.slot,t.name,t.props]);return D.createElement(rt.Provider,{value:o},t.children)},[s])]}let Ks="label";function qs(e,s){let t=ee(),{id:n=`headlessui-label-${t}`,passive:o=!1,...a}=e,i=at(),c=Z(s);B(()=>i.register(n),[n,i.register]);let h={ref:c,...i.props,id:n};return o&&("onClick"in h&&(delete h.htmlFor,delete h.onClick),"onClick"in a&&delete a.onClick),Y({ourProps:h,theirProps:a,slot:i.slot||{},defaultTag:Ks,name:i.name||"Label"})}let Ys=J(qs),Ws=Object.assign(Ys,{}),Ne=l.createContext(null);Ne.displayName="GroupContext";let Xs=l.Fragment;function Js(e){var s;let[t,n]=l.useState(null),[o,a]=Vs(),[i,c]=Yt(),h=l.useMemo(()=>({switch:t,setSwitch:n,labelledby:o,describedby:i}),[t,n,o,i]),d={},f=e;return D.createElement(c,{name:"Switch.Description"},D.createElement(a,{name:"Switch.Label",props:{htmlFor:(s=h.switch)==null?void 0:s.id,onClick(g){t&&(g.currentTarget.tagName==="LABEL"&&g.preventDefault(),t.click(),t.focus({preventScroll:!0}))}}},D.createElement(Ne.Provider,{value:h},Y({ourProps:d,theirProps:f,defaultTag:Xs,name:"Switch.Group"}))))}let Qs="button";function Zs(e,s){var t;let n=ee(),{id:o=`headlessui-switch-${n}`,checked:a,defaultChecked:i=!1,onChange:c,disabled:h=!1,name:d,value:f,form:g,...b}=e,u=l.useContext(Ne),m=l.useRef(null),v=Z(m,s,u===null?null:u.setSwitch),[y,x]=Ze(a,c,i),E=j(()=>x==null?void 0:x(!y)),T=j(M=>{if(Ye(M.currentTarget))return M.preventDefault();M.preventDefault(),E()}),N=j(M=>{M.key===$.Space?(M.preventDefault(),E()):M.key===$.Enter&&xs(M.currentTarget)}),F=j(M=>M.preventDefault()),C=l.useMemo(()=>({checked:y}),[y]),A={id:o,ref:v,role:"switch",type:et(e,m),tabIndex:e.tabIndex===-1?0:(t=e.tabIndex)!=null?t:0,"aria-checked":y,"aria-labelledby":u==null?void 0:u.labelledby,"aria-describedby":u==null?void 0:u.describedby,disabled:h,onClick:T,onKeyUp:N,onKeyPress:F},W=pe();return l.useEffect(()=>{var M;let O=(M=m.current)==null?void 0:M.closest("form");O&&i!==void 0&&W.addEventListener(O,"reset",()=>{x(i)})},[m,x]),D.createElement(D.Fragment,null,d!=null&&y&&D.createElement(Ke,{features:qe.Hidden,...Ge({as:"input",type:"checkbox",hidden:!0,readOnly:!0,disabled:h,form:g,checked:y,name:d,value:f})}),Y({ourProps:A,theirProps:b,slot:C,defaultTag:Qs,name:"Switch"}))}let en=J(Zs),tn=Js,sn=Object.assign(en,{Group:tn,Label:Ws,Description:qt});const S=({className:e,children:s})=>r.jsx("div",{className:z("flex flex-col gap-4 p-4 text-foreground",e),children:s}),nn=({title:e,onClose:s})=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("h2",{className:"text-lg font-medium",children:e}),r.jsx("button",{className:"btn btn-secondary btn-close ml-auto",onClick:s,children:r.jsx(Ee,{})})]}),on=({className:e,as:s="div",children:t})=>s===l.Fragment?r.jsx(l.Fragment,{children:t}):r.jsx(s,{className:e,children:t}),rn=({className:e,children:s})=>r.jsx("div",{className:e,children:s});S.Header=nn;S.Body=on;S.Footer=rn;const it=l.forwardRef(function({type:s="text",className:t="",isFocused:n=!1,...o},a){const i=l.useRef(null);return l.useImperativeHandle(a,()=>({focus:()=>{var c;return(c=i.current)==null?void 0:c.focus()}})),l.useEffect(()=>{var c;n&&((c=i.current)==null||c.focus())},[]),r.jsx("textarea",{...o,className:"form-control "+t,ref:i})}),an=(e,s)=>{const[t,n]=l.useState(e);return l.useEffect(()=>{const o=setTimeout(()=>{n(e)},s);return()=>{clearTimeout(o)}},[e,s]),[t]};function lt({url:e,onChange:s,initialSelected:t,refId:n,disabled:o}){const[a,i]=l.useState([]),[c,h]=l.useState(""),[d]=an(c,300),[f,g]=l.useState(t);l.useEffect(()=>{if(c.length===0)return i([]);window.axios.get(`${e}?query=${c}`).then(v=>{i(v.data.data.filter(y=>f.find(x=>x.id===y.id)===void 0))})},[d]);const b=c===""?a:a.filter(v=>v.name.toLowerCase().includes(c.toLowerCase())),u=v=>{s(v.map(y=>y.id)),g(v)},m=v=>{const y=f.filter(x=>x.id!==v.id);g(y),s(y.map(x=>x.id))};return r.jsxs(re,{value:f,onChange:u,multiple:!0,children:[r.jsxs("div",{className:"form-control combobox relative h-full w-full cursor-default overflow-hidden","aria-disabled":o,tabIndex:-1,children:[f.length>0&&r.jsx("ul",{className:"m-2 flex flex-wrap gap-1 text-xs",children:f.map(v=>r.jsxs("li",{className:"flex items-center justify-between gap-2 rounded-full bg-primary px-2 py-1 text-white",children:[r.jsx("span",{children:v.name}),!o&&r.jsx("button",{className:"flex h-3 w-3 items-center rounded-full bg-white text-sm text-black",type:"button",onClick:()=>m(v),tabIndex:-1,children:r.jsx(Ee,{})})]},v.id))}),r.jsx(re.Input,{onChange:v=>h(v.target.value),displayValue:v=>v.name,className:z("w-full border-none py-2 pl-3 pr-10 leading-5 text-foreground outline-none focus:ring-0",o?"bg-transparent":"bg-background"),id:n,tabIndex:0,"aria-disabled":o}),r.jsx(re.Button,{className:"absolute inset-y-0 right-0 flex items-center pr-2",children:r.jsx(Mt,{className:"h-5 w-5 text-gray-400"})})]}),r.jsx(He,{as:l.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",afterLeave:()=>h(""),children:r.jsx(re.Options,{className:z("absolute mt-1 max-h-60 w-full overflow-auto rounded-md border-gray-200 bg-background text-base shadow-lg focus:outline-none dark:border-gray-500/25 sm:text-sm",(c.length>0||b.length>0)&&"border"),children:b.length===0&&c.length>0?r.jsx("div",{className:"relative cursor-default select-none px-4 py-2 text-foreground",children:"Nothing found."}):b.map(v=>r.jsx(re.Option,{value:v,className:({active:y})=>z("relative cursor-default select-none px-4 py-2",y?"bg-secondary":"text-foreground"),children:({selected:y})=>r.jsxs(r.Fragment,{children:[r.jsx("span",{className:z("block truncate",y?"font-medium":"font-normal"),children:v.name}),y&&r.jsx("span",{className:"absolute inset-y-0 right-2 flex items-center pl-3 text-foreground",children:r.jsx(Rt,{className:"h-5 w-5"})})]})},v.id))})})]})}function ln(){const{closeModal:e}=q(),s=l.useRef(null),{data:t,setData:n,post:o,errors:a,processing:i}=Be({_method:"POST",name:"",description:"",avatar:null,group_members:[]}),c=f=>{f.preventDefault(),!i&&o(route("group.store"),{onSuccess:g=>{const b=g.props;fe.get(route("chats.show",b.user.id)),e()}})},h=f=>{var b;const g=f.target.files;if(g&&g.length>0){n("avatar",g[0]);const u=window.URL.createObjectURL(g[0]);return(b=s.current)==null||b.setAttribute("src",u),()=>{window.URL.revokeObjectURL(u)}}},d=f=>{n("group_members",f)};return r.jsx("form",{onSubmit:c,className:"space-y-4",children:r.jsxs(S,{children:[r.jsx(S.Header,{title:"New Group",onClose:e}),r.jsxs(S.Body,{as:l.Fragment,children:[r.jsxs("div",{className:"picture relative",children:[r.jsx("img",{src:"/images/group-avatar.png",alt:"group-avatar.png",className:"mx-auto h-20 w-20 rounded-full border border-secondary",ref:s}),r.jsxs("label",{htmlFor:"avatar",className:"btn btn-primary absolute left-1/2 top-6 flex translate-x-5 cursor-pointer items-center justify-center rounded-full px-2",tabIndex:0,children:[r.jsx(Ve,{}),r.jsx("input",{type:"file",onChange:h,id:"avatar",className:"hidden"})]}),r.jsx(X,{className:"mt-2 text-center",message:a.avatar})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(oe,{htmlFor:"name",value:"Subject"}),r.jsx(We,{id:"name",type:"text",className:"mt-1 block w-full",value:t.name,onChange:f=>n("name",f.target.value)}),r.jsx(X,{className:"mt-2",message:a.name})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(oe,{htmlFor:"description",value:"Description"}),r.jsx(it,{id:"description",className:"mt-1 block w-full",value:t.description,onChange:f=>n("description",f.target.value)}),r.jsx(X,{className:"mt-2",message:a.description})]}),r.jsxs("div",{className:"relative space-y-2",children:[r.jsx(oe,{htmlFor:"group_members",value:"Add members"}),r.jsx(lt,{url:route("users.index"),onChange:d,initialSelected:[],refId:"group_members"}),r.jsx(X,{className:"mt-2",message:a.group_members})]})]}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-primary flex-1",disabled:i,children:"Save"})]})]})})}const eo=e=>window.axios.get(`${route("contacts.data")}?query=${e||""}`),to=e=>window.axios.get(e),so=e=>window.axios.post(route("contacts.save",e)),cn=e=>window.axios.post(route("contacts.block",e)),no=e=>window.axios.post(route("contacts.unblock",e)),un=e=>window.axios.delete(route("contacts.destroy",e)),oo=({user:e,message:s,attachments:t})=>window.axios.post(route("chats.store"),{to_id:e.id,body:s,attachments:t},{headers:{"Content-Type":"multipart/form-data"}}),dn=e=>window.axios.delete(route("chats.destroy",e.id)),ro=(e,s)=>window.axios.delete(route("chats.delete_file",[e.id,s.file_name])),hn=e=>window.axios.get(route("chats.messages",e.id)),ao=e=>window.axios.get(e),fn=e=>window.axios.get(route("chats.media",e.id)),mn=e=>window.axios.get(route("chats.files",e.id)),pn=e=>window.axios.get(route("chats.links",e.id));var ct=(e=>(e.CHATS="chats",e.GROUP_CHATS="group_chats",e))(ct||{});const io=e=>(e=ie(e).startOf("second").fromNow(),e.replace(/(\d+)\s*(minute?|hour?|day?|week?|month?|year?)s?/,(s,t,n)=>{switch(n){case"minute":return t+"m";case"hour":return t+"h";case"day":return t+"d";case"week":return t+"w";case"month":return t+"M";case"year":return t+"y";default:return s}}).replace(" ago","")),ut=e=>{var n;if(!e)return!1;const s=["jpg","jpeg","png","gif","svg","bmp","webp"],t=((n=e.split(".").pop())==null?void 0:n.toLowerCase())??"";return s.includes(t)},lo=e=>e<1024?e.toFixed(2)+" B":e<1024*1024?(e/1024).toFixed(2)+" KB":e<1024*1024*1024?(e/(1024*1024)).toFixed(2)+" MB":(e/(1024*1024*1024)).toFixed(2)+" GB",dt=e=>e.some(s=>ut(s.original_name)),ht=e=>e.some(s=>!ut(s.original_name)),ft=e=>e&&e.length>0,gn=e=>{const s=document.title,t=/\(\d+\)/;if(t.test(s)){let n=s.replace(t,`(${e})`);e===0&&(n=n.replace("(0) ","")),document.title=n}else if(e>0){const n=`(${e}) ${s}`;document.title=n}},mt={user:{id:"",name:"",email:"",email_verified_at:"",avatar:"",active_status:!1,is_online:!1,last_seen:"",chat_type:ct.CHATS,message_color:"",is_contact_saved:!1,is_contact_blocked:!1,description:"",creator_id:"",creator:{id:"",name:""},members_count:0},messages:[],paginate:Te,media:[],selectedMedia:void 0,files:[],links:[],showSidebarRight:!1,isTyping:!1,setUser:()=>{},setMessages:()=>{},setPaginate:()=>{},setMedia:()=>{},setSelectedMedia:()=>{},clearSelectedMedia:()=>{},setFiles:()=>{},setLinks:()=>{},reloadMedia:()=>{},reloadFiles:()=>{},reloadLinks:()=>{},toggleSidebarRight:()=>{},setIsTyping:()=>{}},xn=(e,s)=>{switch(s.type){case"SET_USER":return{...e,user:s.payload};case"TOGGLE_SIDEBAR_RIGHT":const t=localStorage.getItem("toggle-sidebar-right")==="true";return localStorage.setItem("toggle-sidebar-right",String(!t)),{...e,showSidebarRight:!t};case"SET_MESSAGES":return{...e,messages:s.payload};case"SET_PAGINATE":return{...e,paginate:s.payload};case"SET_MEDIA":return{...e,media:s.payload};case"SET_SELECTED_MEDIA":return{...e,selectedMedia:s.payload};case"SET_FILES":return{...e,files:s.payload};case"SET_LINKS":return{...e,links:s.payload};case"SET_IS_TYPING":return{...e,isTyping:s.payload}}},pt=l.createContext(mt),Me=()=>l.useContext(pt),co=({children:e})=>{const s=le().props,[t,n]=l.useReducer(xn,mt),[o,a]=l.useState(!0),i=C=>n({type:"SET_USER",payload:C}),c=C=>n({type:"SET_MESSAGES",payload:C}),h=C=>n({type:"SET_PAGINATE",payload:C}),d=C=>n({type:"SET_MEDIA",payload:C}),f=C=>n({type:"SET_SELECTED_MEDIA",payload:C}),g=()=>n({type:"SET_SELECTED_MEDIA",payload:void 0}),b=C=>n({type:"SET_FILES",payload:C}),u=C=>n({type:"SET_LINKS",payload:C}),m=C=>{fn(C).then(A=>d(A.data.data))},v=C=>{mn(C).then(A=>b(A.data.data))},y=C=>{pn(C).then(A=>u(A.data.data))},x=()=>n({type:"TOGGLE_SIDEBAR_RIGHT"}),E=C=>n({type:"SET_IS_TYPING",payload:C}),T=()=>{hn(s.user).then(C=>{h(C.data.data),c(C.data.data.data)})},N=C=>{T(),dt(C.chat.attachments)&&m(s.user),ht(C.chat.attachments)&&v(s.user),ft(C.chat.links)&&y(s.user)};l.useEffect(()=>{a(!1),i(s.user),c(s.messages.data),h(s.messages),d(s.media),b(s.files),u(s.links),window.Echo.channel("user-activity").listen(".user-activity",C=>{const A=t.user.id?t.user:s.user;A.id===C.user.id&&i({...A,is_online:C.user.is_online})}),window.Echo.channel(`send-message-${s.user.id}-to-${s.auth.id}`).listen(".send-message",N),window.Echo.channel(`send-group-message-${s.user.id}`).listen(".send-group-message",N)},[]);const F={...t,user:o?s.user:t.user,messages:o?s.messages.data:t.messages,paginate:o?s.messages:t.paginate,media:o?s.media:t.media,files:o?s.files:t.files,links:o?s.links:t.links,showSidebarRight:localStorage.getItem("toggle-sidebar-right")==="true",setUser:i,setMessages:c,setPaginate:h,setMedia:d,setSelectedMedia:f,clearSelectedMedia:g,setFiles:b,setLinks:u,reloadMedia:m,reloadFiles:v,reloadLinks:y,toggleSidebarRight:x,setIsTyping:E};return r.jsx(pt.Provider,{value:F,children:e})},gt={contacts:[],paginate:Te,setContacts:()=>{},setPaginate:()=>{}},bn=(e,s)=>{switch(s.type){case"SET_CONTACTS":return{...e,contacts:s.payload};case"SET_PAGINATE":return{...e,paginate:s.payload}}},xt=l.createContext(gt),bt=()=>l.useContext(xt),uo=({children:e})=>{const s=le().props,[t,n]=l.useReducer(bn,gt),[o,a]=l.useState(!0),i=d=>n({type:"SET_CONTACTS",payload:d}),c=d=>n({type:"SET_PAGINATE",payload:d});l.useEffect(()=>{a(!1),i(s.contacts.data),c(s.contacts),window.Echo.channel("user-activity").listen(".user-activity",d=>{const f=t.contacts.length>0?t.contacts:s.contacts.data;if(Array.isArray(d.user)){const g=d.user;i(f.map(b=>{const u=g.find(m=>m.id===b.id);return u&&(b.is_online=u.is_online),b}))}else{const g=d.user;i(f.map(b=>(b.id===g.id&&(b.is_online=g.is_online),b)))}})},[]);const h={...t,contacts:o?s.contacts.data:t.contacts,paginate:o?s.contacts:t.paginate,setContacts:i,setPaginate:c};return r.jsx(xt.Provider,{value:h,children:e})};function vn(){const{closeModal:e,data:s}=q(),{chats:t,setChats:n}=ge(),{contacts:o,setContacts:a}=bt(),{user:i,setUser:c}=Me();if(!s)return;const h=()=>{cn(s.id).then(()=>{route().current("chats.*")||route().current("archived_chats.*")?(n(t.map(d=>(d.id===s.id&&(d.is_contact_blocked=!0),d))),(i==null?void 0:i.id)===s.id&&c({...i,is_contact_blocked:!0})):a(o.map(d=>(d.id===s.id&&(d.is_contact_blocked=!0),d))),e()})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Block Contact?",onClose:e}),r.jsx(S.Body,{as:l.Fragment,children:r.jsx("p",{children:"This contact will be removed from your contacts. You can save the contact once you open again the block."})}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:h,children:"Block"})]})]})}function yn(){const{closeModal:e,dispatchOnCanceled:s}=q(),{user:t,setUser:n}=Me(),[o,a]=l.useState(null),i=["#2863EB","#2196F3","#00BCD4","#3F51B5","#673AB7","#9C27B0","#F25C55","#FFC107","#FF9800","#ff2522","#4CAF50","#ED9F9B"],c=f=>{a(f),n({...t,message_color:f})},h=()=>{es(t,o).then(()=>{e()})},d=()=>{s&&typeof s=="function"&&s(),e()};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Themes",onClose:d}),r.jsx(S.Body,{className:"grid grid-cols-4 gap-2",children:i.map((f,g)=>r.jsx("button",{className:z("flex h-20 w-20 items-center justify-center rounded-2xl p-2 hover:bg-secondary focus:bg-secondary",f===o&&"bg-secondary"),onClick:()=>c(f),children:r.jsx("span",{className:"inline-block h-16 w-16 shrink-0 rounded-full",style:{background:f}})},g))}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:d,children:"Cancel"}),r.jsx("button",{className:"btn btn-primary flex-1",onClick:h,children:"Save"})]})]})}function Cn(){const{closeModal:e,data:s}=q(),{chats:t,setChats:n}=ge();if(!s)return;const o=()=>{Zt(s).then(()=>{if(route().current("chats.index")||route().current("archived_chats.index")){e(),n([...t.filter(a=>a.id!==s.id)]);return}route().current("chats.*")?fe.replace(route("chats.index")):fe.replace(route("archived_chats.index"))})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Delete Chat?",onClose:e}),r.jsx(S.Body,{as:l.Fragment,children:r.jsx("p",{children:"This chat will be removed for you, including the files. Others in the chat will still be able to see it."})}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:o,children:"Delete for me"})]})]})}function Sn(){const{closeModal:e,data:s}=q(),{contacts:t,setContacts:n}=bt();if(!s)return;const o=()=>{un(s.id).then(()=>{e(),n([...t.filter(a=>a.id!==s.id)])})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Delete Contact?",onClose:e}),r.jsx(S.Body,{as:l.Fragment,children:r.jsx("p",{children:"This contact will be removed for you. It will not appear in your contact list."})}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:o,children:"Delete contact"})]})]})}function wn(){var f;const{closeModal:e,data:s}=q(),{refetchChats:t}=ge(),{messages:n,setMessages:o,user:a,reloadMedia:i,reloadFiles:c,reloadLinks:h}=Me();if(!s)return;const d=()=>{dn(s).then(()=>{t(),o([...n.filter(g=>g.id!==s.id)]),dt(s.attachments)&&i(a),ht(s.attachments)&&c(a),ft(s.links)&&h(a),e()})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Delete Message?",onClose:e}),r.jsxs(S.Body,{as:l.Fragment,children:[r.jsx("p",{children:"This message will be removed for you. Others in the chat will still be able to see it."}),((f=s.attachments)==null?void 0:f.length)>0&&r.jsxs("p",{children:[s.attachments.length," files will be removed for you."]})]}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:d,children:"Delete for me"})]})]})}const jn=e=>window.axios.get(route("group.members",e.id)),En=e=>window.axios.delete(route("group.exit",e.id));function ze({message:e,className:s}){const{setErrorMsg:t,setSuccessMsg:n}=xe(),o=()=>{t(null),n(null)};return r.jsx("div",{className:"fixed bottom-16 left-2 right-2 z-[60] sm:bottom-auto sm:top-2",children:r.jsxs("div",{className:z("flex items-center gap-2 rounded-lg p-4 text-sm sm:ml-auto sm:max-w-lg",s),children:[r.jsx("p",{children:e}),r.jsx("button",{className:"ml-auto text-xl opacity-70 transition-all hover:opacity-100",onClick:o,children:r.jsx(Ee,{})})]})})}const vt={theme:localStorage.getItem("theme")||"system",auth:{id:"",name:"",email:"",email_verified_at:"",avatar:"",active_status:!1,is_online:!1,last_seen:"",is_contact_blocked:!1,is_contact_saved:!1},notificationCount:0,setTheme:()=>{},setAuth:()=>{},setErrorMsg:()=>{},setSuccessMsg:()=>{},syncNotification:()=>{}},Tn=(e,s)=>{switch(s.type){case"SET_THEME":const t=s.payload,n=document.documentElement;switch(n&&(n.classList.remove("dark"),n.classList.remove("light")),t){case"system":window.matchMedia("(prefers-color-scheme: dark)").matches?n.classList.add("dark"):n.classList.add("light");break;case"dark":n.classList.add("dark");break;case"light":n.classList.add("light")}return localStorage.setItem("theme",t),{...e,theme:t};case"SET_AUTH":return{...e,auth:s.payload};case"SET_ERROR_MSG":return{...e,errorMsg:s.payload};case"SET_SUCCESS_MSG":return{...e,successMsg:s.payload};case"SET_NOTIFICATION_COUNT":return{...e,notificationCount:s.payload}}},yt=l.createContext(vt),xe=()=>l.useContext(yt),In=({children:e})=>{const s=le().props,[t,n]=l.useReducer(Tn,vt),[o,a]=l.useState(!0),i=l.useRef(null),c=m=>n({type:"SET_THEME",payload:m}),h=m=>n({type:"SET_AUTH",payload:m}),d=m=>n({type:"SET_ERROR_MSG",payload:m}),f=m=>n({type:"SET_SUCCESS_MSG",payload:m}),g=m=>n({type:"SET_NOTIFICATION_COUNT",payload:m}),b=async()=>{const m=localStorage.getItem("last-sync-notification"),v=ie();if(!(m&&v.diff(ie(parseInt(m)))<3e3))return localStorage.setItem("last-sync-notification",v.valueOf().toString()),await Qt().then(y=>{g(y.data.data.notification_count)})};l.useEffect(()=>{h(s.auth),g(s.notification_count),a(!1),s.error_msg&&d(s.error_msg),s.success_msg&&f(s.success_msg),window.Echo.channel(`send-message-${s.auth.id}`).listen(".send-message",()=>{b().then(()=>{var m;(m=i.current)==null||m.play()})})},[]),l.useEffect(()=>{t.errorMsg&&setTimeout(()=>d(null),5e3),t.successMsg&&setTimeout(()=>f(null),5e3)},[t.errorMsg,t.successMsg]),l.useEffect(()=>{!o&&gn(t.notificationCount)},[t.notificationCount]);const u={...t,theme:localStorage.getItem("theme")||"system",auth:o?s.auth:t.auth,notificationCount:o?s.notification_count:t.notificationCount,setTheme:c,setAuth:h,setErrorMsg:d,setSuccessMsg:f,syncNotification:b};return r.jsxs(yt.Provider,{value:u,children:[e,t.errorMsg&&r.jsx(ze,{message:t.errorMsg,className:"bg-danger text-white"}),t.successMsg&&r.jsx(ze,{message:t.successMsg,className:"bg-success text-white"}),r.jsxs("audio",{controls:!0,className:"hidden",ref:i,children:[r.jsx("source",{src:"/audios/notification.mp3",type:"audio/mpeg"}),"Your browser does not support the audio element."]})]})};function On(){const{auth:e}=xe(),{closeModal:s,data:t}=q(),[n,o]=l.useState(!1),[a,i]=l.useState([]),c=l.useRef(null),{data:h,setData:d,post:f,errors:g,processing:b}=Be({_method:"PATCH",name:t==null?void 0:t.name,description:t==null?void 0:t.description,avatar:null,group_members:[]});l.useEffect(()=>{jn(t).then(x=>{const E=x.data.data.map(T=>({id:T.id,name:T.name}));i(E),o(!0),d("group_members",E.map(T=>T.id))})},[]);const u=e.id===(t==null?void 0:t.creator_id),m=x=>{x.preventDefault(),!(b||!u)&&f(route("group.update",t==null?void 0:t.id),{onSuccess:E=>{const T=E.props;fe.get(route("chats.show",T.user.id)),s()}})},v=x=>{var T;const E=x.target.files;if(E&&E.length>0){d("avatar",E[0]);const N=window.URL.createObjectURL(E[0]);return(T=c.current)==null||T.setAttribute("src",N),()=>{window.URL.revokeObjectURL(N)}}},y=x=>{d("group_members",x)};return r.jsx("form",{onSubmit:m,className:"space-y-4",children:r.jsxs(S,{children:[r.jsx(S.Header,{title:"Group Detail",onClose:s}),r.jsx(S.Body,{as:l.Fragment,children:n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"picture relative",children:[r.jsx("img",{src:t==null?void 0:t.avatar,alt:t==null?void 0:t.name,className:"mx-auto h-20 w-20 rounded-full border border-secondary",ref:c}),u&&r.jsxs("label",{htmlFor:"avatar",className:"btn btn-primary absolute left-1/2 top-6 flex translate-x-5 cursor-pointer items-center justify-center rounded-full px-2",tabIndex:0,children:[r.jsx(Ve,{}),r.jsx("input",{type:"file",onChange:v,id:"avatar",className:"hidden"})]}),r.jsx(X,{className:"mt-2 text-center",message:g.avatar})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(oe,{htmlFor:"name",value:"Subject"}),r.jsx(We,{id:"name",type:"text",className:"mt-1 block w-full",value:h.name,onChange:x=>d("name",x.target.value),disabled:!u}),r.jsx(X,{className:"mt-2",message:g.name})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(oe,{htmlFor:"description",value:"Description"}),r.jsx(it,{id:"description",className:"mt-1 block w-full",value:h.description,onChange:x=>d("description",x.target.value),disabled:!u}),r.jsx(X,{className:"mt-2",message:g.description})]}),r.jsxs("div",{className:"relative space-y-2",children:[r.jsx(oe,{htmlFor:"group_members",value:"Add members"}),r.jsx(lt,{url:route("users.index"),onChange:y,initialSelected:a,refId:"group_members",disabled:!u}),r.jsx(X,{className:"mt-2",message:g.group_members})]})]}):r.jsx("p",{className:"p-4",children:"Loading..."})}),u&&r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:s,children:"Cancel"}),r.jsx("button",{className:"btn btn-primary flex-1",disabled:b,children:"Save"})]})]})})}function _n(){const{closeModal:e,data:s}=q(),{chats:t,setChats:n}=ge(),o=()=>{En(s).then(()=>{n(t.filter(a=>a.id!==(s==null?void 0:s.id))),e()})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:`Exit "${s==null?void 0:s.name}" group?`,onClose:e}),r.jsx(S.Body,{as:l.Fragment,children:r.jsx("p",{children:"This group will be removed for you. You can not see anything in this group."})}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:o,children:"Exit group"})]})]})}const be=l.createContext({open:!1,setOpen:()=>{},toggleOpen:()=>{}}),ho=()=>l.useContext(be),ue=({children:e})=>{const[s,t]=l.useState(!1),n=()=>{t(o=>!o)};return r.jsx(be.Provider,{value:{open:s,setOpen:t,toggleOpen:n},children:r.jsx("div",{className:"relative",children:e})})},Nn=({children:e})=>{const{open:s,setOpen:t,toggleOpen:n}=l.useContext(be);return r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:n,children:e}),s&&r.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>t(!1)})]})},Mn=({align:e="right",width:s="48",contentClasses:t="py-1 bg-background",children:n})=>{const{open:o,setOpen:a}=l.useContext(be);let i="origin-top";e==="left"?i="origin-top-left end-0 sm:start-0 mt-2":e==="right"?i="origin-top-right end-0 mt-2":e==="top-left"?i="origin-bottom-left bottom-0 end-0 sm:start-0 mb-2":e==="top-right"&&(i="origin-bottom-right bottom-0 end-0 mb-2");let c="";return s==="48"&&(c="w-48"),r.jsx(r.Fragment,{children:r.jsx(He,{as:l.Fragment,show:o,enter:"transition ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:r.jsx("div",{className:`absolute z-50 ${i} ${c}`,onClick:()=>a(!1),children:r.jsx("div",{className:"rounded-lg bg-background !p-2 shadow-md ring-1 ring-black ring-opacity-5 dark:ring-white dark:ring-opacity-5 "+t,children:n})})})})},Rn=({className:e="",children:s,...t})=>r.jsx(ae,{...t,className:"block w-full rounded-md px-4 py-2 text-start text-sm leading-5 text-foreground transition duration-150 ease-in-out hover:bg-secondary focus:bg-secondary focus:outline-none "+e,children:s}),kn=({className:e="",children:s,...t})=>r.jsx("button",{...t,className:"block w-full rounded-md px-4 py-2 text-start text-sm leading-5 text-foreground transition duration-150 ease-in-out hover:bg-secondary focus:bg-secondary focus:outline-none "+e,children:s});ue.Trigger=Nn;ue.Content=Mn;ue.Link=Rn;ue.Button=kn;const V=ue,Fn=(e,s)=>window.axios.patch(route("users.update",e.id),{email:e.email,name:e.name,...s});function An(){const{theme:e,auth:s,setTheme:t,setAuth:n}=xe(),{closeModal:o}=q(),a=i=>{Fn(s,{active_status:i}).then(()=>{n({...s,active_status:i})})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Preferences",onClose:o}),r.jsxs(S.Body,{className:"flex",as:l.Fragment,children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(kt,{}),"Theme"]}),r.jsxs(V,{children:[r.jsx(V.Trigger,{children:r.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",children:[e.charAt(0).toUpperCase()+e.slice(1),r.jsx(Ft,{})]})}),r.jsxs(V.Content,{children:[r.jsx(V.Button,{onClick:()=>t("system"),children:"System"}),r.jsx(V.Button,{onClick:()=>t("dark"),children:"Dark"}),r.jsx(V.Button,{onClick:()=>t("light"),children:"Light"})]})]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(At,{}),"Active Status"]}),r.jsxs(sn,{checked:s.active_status,onChange:a,className:z("relative inline-flex h-6 w-11 items-center rounded-full",s.active_status?"bg-primary":"bg-secondary"),children:[r.jsx("span",{className:"sr-only",children:"Enable active status"}),r.jsx("span",{className:`${s.active_status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition`})]})]})]})]})}const Ct={isOpen:!1,openModal:()=>{},closeModal:()=>{}},Pn=(e,s)=>{switch(s.type){case"OPEN":return{...e,view:s.view,size:s.size,data:s.payload,isOpen:!0,dispatchOnCanceled:s.payload&&s.payload.dispatchOnCanceled&&s.payload.dispatchOnCanceled};case"CLOSE":return{...e,view:void 0,size:void 0,data:void 0,isOpen:!1,dispatchOnCanceled:void 0}}},St=l.createContext(Ct);function q(){return l.useContext(St)}const fo=({children:e})=>{const[s,t]=l.useReducer(Pn,Ct),a={...s,openModal:({view:i,size:c,payload:h})=>t({type:"OPEN",view:i,size:c,payload:h}),closeModal:()=>t({type:"CLOSE"})};return r.jsxs(St.Provider,{value:a,children:[e,r.jsx(Dn,{})]})},Dn=()=>{const{isOpen:e,view:s,size:t,closeModal:n,dispatchOnCanceled:o}=q(),a=()=>{o&&typeof o=="function"&&o(),n()};return r.jsxs(Wt,{show:e,onClose:a,maxWidth:t,children:[s==="PREFERENCES"&&r.jsx(An,{}),s==="DELETE_MESSAGE_CONFIRMATION"&&r.jsx(wn,{}),s==="DELETE_CHAT_CONFIRMATION"&&r.jsx(Cn,{}),s==="BLOCK_CONTACT_CONFIRMATION"&&r.jsx(vn,{}),s==="CUSTOMIZE_CHAT"&&r.jsx(yn,{}),s==="ADD_NEW_GROUP"&&r.jsx(ln,{}),s==="EDIT_GROUP"&&r.jsx(On,{}),s==="EXIT_GROUP_CONFIRMATION"&&r.jsx(_n,{}),s==="DELETE_CONTACT_CONFIRMATION"&&r.jsx(Sn,{})]})};function mo({title:e,children:s}){const{notification_count:t}=le().props;return r.jsxs(In,{children:[r.jsx(Ot,{title:z(t>0&&`(${t})`,e)}),r.jsx("div",{className:"flex h-screen flex-col overflow-hidden bg-background text-foreground sm:flex-row",children:s})]})}function Ln(){return r.jsx("span",{className:"absolute -mr-5 -mt-5 h-2.5 w-2.5 rounded-full bg-primary ring-2 ring-white sm:right-2.5 sm:top-2.5 sm:mr-0 sm:mt-0"})}const $n=()=>{const[e,s]=l.useState({width:window.innerWidth,height:window.innerHeight});return l.useEffect(()=>{const t=()=>{s({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]),e};function po(){const{auth:e,notificationCount:s}=xe(),{openModal:t}=q(),{width:n}=$n(),o=()=>{t({view:"PREFERENCES",size:"lg"})};return r.jsxs("div",{className:z("order-2 mt-auto flex-row justify-between bg-background sm:order-1 sm:mt-0 sm:flex sm:flex-col sm:items-center sm:justify-center sm:p-2",route().current("chats.show")?"hidden":"flex"),children:[r.jsxs(ae,{href:route("chats.index"),className:z("relative flex flex-1 items-center justify-center rounded-lg p-3 transition-all hover:bg-secondary sm:flex-initial",route().current("chats.*")&&"bg-secondary"),children:[r.jsx(Pt,{className:"h-6 w-6"}),s>0&&r.jsx(Ln,{})]}),r.jsx(ae,{href:route("contacts.index"),className:z("flex flex-1 items-center justify-center rounded-lg p-3 transition-all hover:bg-secondary sm:flex-initial",route().current("contacts.*")&&"bg-secondary"),children:r.jsx(Dt,{className:"h-6 w-6"})}),r.jsx(ae,{href:route("archived_chats.index"),className:z("flex flex-1 items-center justify-center rounded-lg p-3 transition-all hover:bg-secondary sm:flex-initial",route().current("archived_chats.*")&&"bg-secondary"),children:r.jsx(Lt,{className:"h-6 w-6"})}),n<=640?r.jsx(ae,{href:route("preferences.index"),className:z("flex flex-1 items-center justify-center rounded-lg p-3 transition-all hover:bg-secondary sm:flex-initial",route().current("preferences.index")&&"bg-secondary"),children:r.jsx("img",{src:e.avatar,alt:"",className:"h-8 w-8 rounded-full border border-secondary sm:h-10 sm:w-10"})}):r.jsx("div",{className:"relative flex flex-1 cursor-pointer items-center justify-center rounded-lg px-3 transition-all hover:bg-secondary sm:mt-auto sm:flex-initial sm:px-0 sm:hover:bg-transparent",children:r.jsxs(V,{children:[r.jsx(V.Trigger,{children:r.jsx("img",{src:e.avatar,alt:"",className:"h-8 w-8 rounded-full border border-secondary sm:h-10 sm:w-10"})}),r.jsxs(V.Content,{align:"top-left",contentClasses:"mb-12 sm:mb-10",children:[r.jsx(V.Button,{onClick:o,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx($t,{}),"Preferences"]})}),r.jsx(V.Link,{href:route("profile.edit"),children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(zt,{}),"Profile"]})}),r.jsx(V.Link,{href:route("logout"),method:"post",as:"button",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Bt,{}),"Log out"]})})]})]})})]})}export{mo as A,eo as B,Zn as C,V as D,to as E,uo as F,$n as G,Fn as H,fo as M,po as S,et as T,sn as _,co as a,Me as b,ct as c,q as d,ro as e,dt as f,ht as g,lo as h,xe as i,ut as j,ao as k,oo as l,ft as m,no as n,an as o,Xt as p,ho as q,Wn as r,so as s,Xn as t,ge as u,Jn as v,Qn as w,Yn as x,io as y,bt as z};
